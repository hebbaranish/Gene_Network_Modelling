use id_gen as it can handle constant nodes=0
